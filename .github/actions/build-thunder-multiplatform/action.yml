name: 'Build Thunder Multi-Platform'
description: 'Builds Thunder frontend and backend for all supported platforms'
author: 'WSO2'

runs:
  using: composite
  steps:
    - name: ğŸ”¨ Build Thunder for All Platforms
      shell: bash
      run: |
        # Define platform matrix
        PLATFORMS=(
          "windows:amd64"
          "linux:amd64"
          "linux:arm64"
          "darwin:amd64"
          "darwin:arm64"
        )

        echo "ğŸ—ï¸ Building Thunder for ${#PLATFORMS[@]} platforms..."

        # Build frontend once (platform-agnostic)
        echo "ğŸ”¨ Building frontend..."
        make build_frontend

        # Build backend for each platform
        for platform in "${PLATFORMS[@]}"; do
          OS="${platform%%:*}"
          ARCH="${platform#*:}"
          echo "ğŸ”¨ Building Thunder backend for $OS/$ARCH..."
          make build_backend OS=$OS ARCH=$ARCH
          sleep 1
        done

        echo "âœ… Thunder built for all platforms successfully!"
