/**
 * Copyright (c) 2025, WSO2 LLC. (https://www.wso2.com).
 *
 * WSO2 LLC. licenses this file to you under the Apache License,
 * Version 2.0 (the "License"); you may not use this file except
 * in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing,
 * software distributed under the License is distributed on an
 * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 * KIND, either express or implied. See the License for the
 * specific language governing permissions and limitations
 * under the License.
 */

/**
 * Identity Provider Types
 *
 * Supported identity provider types in the Thunder platform.
 * These represent different authentication protocols and social login providers.
 *
 * @public
 */
export const IdentityProviderTypes = {
  /** Generic OAuth 2.0 provider */
  OAUTH: 'OAUTH',
  /** OpenID Connect provider */
  OIDC: 'OIDC',
  /** Google OAuth provider */
  GOOGLE: 'GOOGLE',
  /** GitHub OAuth provider */
  GITHUB: 'GITHUB',
} as const;

/**
 * Identity Provider Type
 *
 * Type alias that derives all supported identity provider values
 * from {@link IdentityProviderTypes}.
 *
 * @public
 * @example
 * ```ts
 * const provider: IdentityProviderType = IdentityProviderTypes.GOOGLE;
 * ```
 */
export type IdentityProviderType = (typeof IdentityProviderTypes)[keyof typeof IdentityProviderTypes];

/**
 * Identity Provider Property
 *
 * Represents a configuration property for an identity provider.
 * Properties can be either public configuration values or sensitive secrets.
 *
 * @public
 * @example
 * ```typescript
 * // Public property
 * const redirectUri: IdentityProviderProperty = {
 *   name: 'redirect_uri',
 *   value: 'https://localhost:5091/signin',
 *   is_secret: false
 * };
 *
 * // Secret property (value is masked when retrieved)
 * const clientSecret: IdentityProviderProperty = {
 *   name: 'client_secret',
 *   value: '******',
 *   is_secret: true
 * };
 * ```
 */
export interface IdentityProviderProperty {
  /**
   * The name of the property (e.g., 'client_id', 'client_secret', 'scopes')
   */
  name: string;

  /**
   * The value of the property
   * For secret properties, this will be masked (e.g., '******') in GET responses
   */
  value: string;

  /**
   * Indicates whether this property contains sensitive information
   * Secret properties are masked in API responses and stored securely
   * @defaultValue false
   */
  is_secret?: boolean;
}

/**
 * Identity Provider Response Model (Basic)
 *
 * Basic identity provider information returned in list operations.
 * Contains only high-level metadata without sensitive configuration details.
 *
 * @public
 * @remarks
 * This model is returned by GET /identity-providers (list endpoint).
 * For full details including properties, use {@link IdentityProvider}.
 *
 * @example
 * ```typescript
 * // Example response from GET /identity-providers
 * const idpList: BasicIdentityProvider[] = [
 *   {
 *     id: 'ec08e7c1-8f9c-4a89-b40c-886a938f7707',
 *     name: 'Google',
 *     description: 'Login with Google',
 *     type: IdentityProviderTypes.GOOGLE
 *   }
 * ];
 * ```
 */
export interface BasicIdentityProvider {
  /**
   * Unique identifier of the identity provider
   * Generated by the server upon creation
   */
  id: string;

  /**
   * The name of the identity provider
   */
  name: string;

  /**
   * Optional description of the identity provider
   */
  description?: string;

  /**
   * The type of identity provider
   */
  type: IdentityProviderType;
}

/**
 * Identity Provider Response Model (Full)
 *
 * Complete identity provider information including all configuration properties.
 * This is the full representation returned when fetching a specific identity provider.
 *
 * @public
 * @remarks
 * This model is returned by:
 * - GET /identity-providers/:id (get by ID)
 * - POST /identity-providers (create)
 * - PUT /identity-providers/:id (update)
 *
 * Secret property values are masked in responses (shown as '******').
 *
 * @example
 * ```typescript
 * // Example response from GET /identity-providers/:id
 * const googleIdp: IdentityProvider = {
 *   id: 'ec08e7c1-8f9c-4a89-b40c-886a938f7707',
 *   name: 'Google',
 *   description: 'Login with Google',
 *   type: IdentityProviderTypes.GOOGLE,
 *   properties: [
 *     { name: 'client_id', value: '******', is_secret: true },
 *     { name: 'client_secret', value: '******', is_secret: true },
 *     { name: 'redirect_uri', value: 'https://localhost:5091/signin', is_secret: false },
 *     { name: 'prompt', value: 'select_account', is_secret: false },
 *     { name: 'scopes', value: 'openid,email,profile', is_secret: false }
 *   ]
 * };
 * ```
 */
export interface IdentityProvider extends BasicIdentityProvider {
  /**
   * Configuration properties for the identity provider
   * Contains both public configuration and masked secret values
   */
  properties?: IdentityProviderProperty[];
}
