openapi: 3.0.3
info:
  title: Branding Management API
  version: "1.0"
  description: This API is used to manage branding configurations that can be associated with applications.
  license:
    name: Apache 2.0
    url: https://www.apache.org/licenses/LICENSE-2.0.html

servers:
  - url: https://{host}:{port}
    variables:
      host:
        default: "localhost"
      port:
        default: "8090"

tags:
  - name: branding
    description: Operations related to branding configuration management

security:
  - OAuth2: [system]

paths:
  /branding:
    get:
      tags:
        - branding
      summary: List branding configurations
      description: Retrieve a list of all branding configurations.
      parameters:
        - $ref: '#/components/parameters/limitQueryParam'
        - $ref: '#/components/parameters/offsetQueryParam'
      responses:
        "200":
          description: List of branding configurations
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BrandingListResponse'
              example:
                totalResults: 3
                startIndex: 1
                count: 3
                brandings:
                  - id: "3fa85f64-5717-4562-b3fc-2c963f66afa6"
                    displayName: "Application 1 Branding"
                  - id: "4fa85f64-5717-4562-b3fc-2c963f66afa7"
                    displayName: "Application 2 Branding"
                  - id: "5fa85f64-5717-4562-b3fc-2c963f66afa8"
                    displayName: "Application 3 Branding"
                links:
                  - href: "branding?offset=3&limit=10"
                    rel: "next"
        "400":
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              examples:
                invalid-limit:
                  summary: Invalid limit parameter
                  value:
                    code: "BRD-1008"
                    message: "Invalid limit parameter"
                    description: "The limit parameter must be a positive integer"
                invalid-offset:
                  summary: Invalid offset parameter
                  value:
                    code: "BRD-1009"
                    message: "Invalid offset parameter"
                    description: "The offset parameter must be a non-negative integer"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                code: "BRD-5000"
                message: "Internal server error"
                description: "An unexpected error occurred while processing the request"

    post:
      tags:
        - branding
      summary: Create a branding configuration
      description: Creates a new branding configuration with the provided preferences.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateBrandingRequest'
            example:
              displayName: "Application 1 Branding"
              preferences:
                theme:
                  activeColorScheme: "dark"
                  colorSchemes:
                    dark:
                      colors:
                        primary:
                          main: "#1976d2"
                          dark: "#0d47a1"
                          contrastText: "#ffffff"
                        secondary:
                          main: "#9c27b0"
                          dark: "#6a0080"
                          contrastText: "#ffffff"
                        tertiary:
                          main: "#2e7d32"
                          dark: "#1b5e20"
                          contrastText: "#ffffff"
      responses:
        "201":
          description: Branding configuration created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BrandingResponse'
              example:
                id: "3fa85f64-5717-4562-b3fc-2c963f66afa6"
                displayName: "Application 1 Branding"
                preferences:
                  theme:
                    activeColorScheme: "dark"
                    colorSchemes:
                      dark:
                        colors:
                          primary:
                            main: "#1976d2"
                            dark: "#0d47a1"
                            contrastText: "#ffffff"
                          secondary:
                            main: "#9c27b0"
                            dark: "#6a0080"
                            contrastText: "#ffffff"
                          tertiary:
                            main: "#2e7d32"
                            dark: "#1b5e20"
                            contrastText: "#ffffff"
        "400":
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              examples:
                invalid-request-format:
                  summary: Invalid request format
                  value:
                    code: "BRD-1001"
                    message: "Invalid request format"
                    description: "The request body is malformed or contains invalid data"
                missing-display-name:
                  summary: Missing display name field
                  value:
                    code: "BRD-1005"
                    message: "Invalid request format"
                    description: "The 'displayName' field is required"
                missing-preferences:
                  summary: Missing preferences field
                  value:
                    code: "BRD-1006"
                    message: "Invalid request format"
                    description: "The 'preferences' field is required"
                invalid-preferences:
                  summary: Invalid preferences structure
                  value:
                    code: "BRD-1007"
                    message: "Invalid preferences structure"
                    description: "The preferences must be a valid JSON object"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                code: "BRD-5000"
                message: "Internal server error"
                description: "An unexpected error occurred while processing the request"

  /branding/{id}:
    get:
      tags:
        - branding
      summary: Get a branding configuration by ID
      description: Retrieve a specific branding configuration using its ID.
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
            format: uuid
          description: Branding configuration ID
          example: "3fa85f64-5717-4562-b3fc-2c963f66afa6"
      responses:
        "200":
          description: Branding configuration details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BrandingResponse'
              example:
                id: "3fa85f64-5717-4562-b3fc-2c963f66afa6"
                displayName: "Application 1 Branding"
                preferences:
                  theme:
                    activeColorScheme: "dark"
                    colorSchemes:
                      dark:
                        colors:
                          primary:
                            main: "#1976d2"
                            dark: "#0d47a1"
                            contrastText: "#ffffff"
                          secondary:
                            main: "#9c27b0"
                            dark: "#6a0080"
                            contrastText: "#ffffff"
                          tertiary:
                            main: "#2e7d32"
                            dark: "#1b5e20"
                            contrastText: "#ffffff"
                      light:
                        colors:
                          primary:
                            main: "#2196f3"
                            dark: "#1976d2"
                            contrastText: "#ffffff"
        "400":
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                code: "BRD-1002"
                message: "Invalid request format"
                description: "Branding ID is required"
        "404":
          description: Branding configuration not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                code: "BRD-1003"
                message: "Branding configuration not found"
                description: "The branding configuration with the specified id does not exist"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                code: "BRD-5000"
                message: "Internal server error"
                description: "An unexpected error occurred while processing the request"

    put:
      tags:
        - branding
      summary: Update branding configuration
      description: Updates an existing branding configuration with new preferences.
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
            format: uuid
          description: Branding configuration ID
          example: "3fa85f64-5717-4562-b3fc-2c963f66afa6"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateBrandingRequest'
            example:
              displayName: "Application 2 Branding"
              preferences:
                theme:
                  activeColorScheme: "light"
                  colorSchemes:
                    light:
                      colors:
                        primary:
                          main: "#2196f3"
                          dark: "#1976d2"
                          contrastText: "#ffffff"
                        secondary:
                          main: "#9c27b0"
                          dark: "#6a0080"
                          contrastText: "#ffffff"
                    dark:
                      colors:
                        primary:
                          main: "#1976d2"
                          dark: "#0d47a1"
                          contrastText: "#ffffff"
                        secondary:
                          main: "#9c27b0"
                          dark: "#6a0080"
                          contrastText: "#ffffff"
      responses:
        "200":
          description: Branding configuration updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BrandingResponse'
              example:
                id: "3fa85f64-5717-4562-b3fc-2c963f66afa6"
                displayName: "Application 2 Branding"
                preferences:
                  theme:
                    activeColorScheme: "light"
                    colorSchemes:
                      light:
                        colors:
                          primary:
                            main: "#2196f3"
                            dark: "#1976d2"
                            contrastText: "#ffffff"
                          secondary:
                            main: "#9c27b0"
                            dark: "#6a0080"
                            contrastText: "#ffffff"
                      dark:
                        colors:
                          primary:
                            main: "#1976d2"
                            dark: "#0d47a1"
                            contrastText: "#ffffff"
                          secondary:
                            main: "#9c27b0"
                            dark: "#6a0080"
                            contrastText: "#ffffff"
        "400":
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              examples:
                missing-branding-id:
                  summary: Missing branding ID
                  value:
                    code: "BRD-1002"
                    message: "Invalid request format"
                    description: "Branding ID is required"
                invalid-request-format:
                  summary: Invalid request format
                  value:
                    code: "BRD-1001"
                    message: "Invalid request format"
                    description: "The request body is malformed or contains invalid data"
                missing-display-name:
                  summary: Missing display name field
                  value:
                    code: "BRD-1005"
                    message: "Invalid request format"
                    description: "The 'displayName' field is required"
                missing-preferences:
                  summary: Missing preferences field
                  value:
                    code: "BRD-1006"
                    message: "Invalid request format"
                    description: "The 'preferences' field is required"
                invalid-preferences:
                  summary: Invalid preferences structure
                  value:
                    code: "BRD-1007"
                    message: "Invalid preferences structure"
                    description: "The preferences must be a valid JSON object"
        "404":
          description: Branding configuration not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                code: "BRD-1003"
                message: "Branding configuration not found"
                description: "The branding configuration with the specified id does not exist"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                code: "BRD-5000"
                message: "Internal server error"
                description: "An unexpected error occurred while processing the request"

    delete:
      tags:
        - branding
      summary: Delete a branding configuration by ID
      description: Deletes a branding configuration. If the branding is currently associated with any applications, the deletion will fail.
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
            format: uuid
          description: Branding configuration ID
          example: "3fa85f64-5717-4562-b3fc-2c963f66afa6"
      responses:
        "204":
          description: Branding configuration deleted or already deleted
        "400":
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              examples:
                missing-branding-id:
                  summary: Missing branding ID
                  value:
                    code: "BRD-1002"
                    message: "Invalid request format"
                    description: "Branding ID is required"
        "409":
          description: Conflict
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                code: "BRD-1004"
                message: "Cannot delete branding"
                description: "Cannot delete branding configuration that is currently associated with one or more applications"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                code: "BRD-5000"
                message: "Internal server error"
                description: "An unexpected error occurred while processing the request"

  /branding/resolve:
    get:
      tags:
        - branding
      summary: Resolve a branding configuration
      description: Retrieve a branding configuration by type and ID.
      security: []
      parameters:
        - in: query
          name: type
          required: true
          schema:
            type: string
            enum: [APP, OU]
          description: Type of entity to resolve branding for. Currently only APP is supported.
          example: "APP"
        - in: query
          name: id
          required: true
          schema:
            type: string
            format: uuid
          description: ID of the application or organizational unit
          example: "3fa85f64-5717-4562-b3fc-2c963f66afa6"
      responses:
        "200":
          description: Branding configuration details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BrandingResponse'
              example:
                id: "3fa85f64-5717-4562-b3fc-2c963f66afa6"
                displayName: "Application 1 Branding"
                preferences:
                  theme:
                    activeColorScheme: "dark"
                    colorSchemes:
                      dark:
                        colors:
                          primary:
                            main: "#1976d2"
                            dark: "#0d47a1"
                            contrastText: "#ffffff"
                          secondary:
                            main: "#9c27b0"
                            dark: "#6a0080"
                            contrastText: "#ffffff"
                          tertiary:
                            main: "#2e7d32"
                            dark: "#1b5e20"
                            contrastText: "#ffffff"
        "400":
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              examples:
                missing-type:
                  summary: Missing type parameter
                  value:
                    code: "BRD-1010"
                    message: "Invalid request format"
                    description: "The 'type' query parameter is required and must be either 'APP' or 'OU'"
                missing-id:
                  summary: Missing id parameter
                  value:
                    code: "BRD-1011"
                    message: "Invalid request format"
                    description: "The 'id' query parameter is required"
                unsupported-type:
                  summary: Unsupported resolve type
                  value:
                    code: "BRD-1012"
                    message: "Unsupported resolve type"
                    description: "The specified resolve type is not yet supported. Currently only 'APP' type is supported"
        "404":
          description: |
            Not found. This error is returned in the following scenarios:
            1. The specified application or organizational unit does not exist (error code BRD-1014).
            2. The application or organizational unit exists but has no associated branding configuration (error code BRD-1013).
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              examples:
                application-not-found:
                  summary: Application not found
                  value:
                    code: "BRD-1014"
                    message: "Application not found"
                    description: "The application with the specified id does not exist"
                application-has-no-branding:
                  summary: Application has no branding
                  value:
                    code: "BRD-1013"
                    message: "Application has no branding"
                    description: "The specified application does not have an associated branding configuration"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                code: "BRD-5000"
                message: "Internal server error"
                description: "An unexpected error occurred while processing the request"

components:
  securitySchemes:
    OAuth2:
      type: oauth2
      flows:
        authorizationCode:
          authorizationUrl: https://localhost:8090/oauth2/authorize
          tokenUrl: https://localhost:8090/oauth2/token
          scopes:
            system: Access to system management APIs

  parameters:
    limitQueryParam:
      in: query
      name: limit
      required: false
      description: Maximum number of records to return. Must be between 1 and 100 inclusive.
      schema:
        type: integer
        minimum: 1
        maximum: 100
        default: 30
    offsetQueryParam:
      in: query
      name: offset
      required: false
      description: Number of records to skip for pagination. Must be a non-negative integer.
      schema:
        type: integer
        minimum: 0
        default: 0

  schemas:
    BrandingResponse:
      type: object
      required: [id, displayName, preferences]
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier for the branding configuration
          example: "3fa85f64-5717-4562-b3fc-2c963f66afa6"
        displayName:
          type: string
          description: Display name for the branding configuration
          example: "Application 1 Branding"
        preferences:
          $ref: '#/components/schemas/BrandingPreferences'

    BrandingListItem:
      type: object
      required: [id, displayName]
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier for the branding configuration
          example: "3fa85f64-5717-4562-b3fc-2c963f66afa6"
        displayName:
          type: string
          description: Display name for the branding configuration
          example: "Application 1 Branding"

    BrandingListResponse:
      type: object
      required: [totalResults, startIndex, count, brandings]
      properties:
        totalResults:
          type: integer
          description: Number of results that match the listing operation.
          example: 8
        startIndex:
          type: integer
          description: Index of the first element of the page, which will be equal to offset + 1.
          example: 1
        count:
          type: integer
          description: Number of elements in the returned page.
          example: 5
        brandings:
          type: array
          items:
            $ref: '#/components/schemas/BrandingListItem'
        links:
          type: array
          items:
            $ref: '#/components/schemas/Link'

    CreateBrandingRequest:
      type: object
      required: [displayName, preferences]
      properties:
        displayName:
          type: string
          description: Display name for the branding configuration
          example: "Application 1 Branding"
        preferences:
          $ref: '#/components/schemas/BrandingPreferences'

    UpdateBrandingRequest:
      type: object
      required: [displayName, preferences]
      properties:
        displayName:
          type: string
          description: Display name for the branding configuration
          example: "Application 2 Branding"
        preferences:
          $ref: '#/components/schemas/BrandingPreferences'

    BrandingPreferences:
      type: object
      description: Branding preferences stored as flexible JSON. The structure can evolve over time.
      additionalProperties: true
      example:
        theme:
          activeColorScheme: "dark"
          colorSchemes:
            dark:
              colors:
                primary:
                  main: "#1976d2"
                  dark: "#0d47a1"
                  contrastText: "#ffffff"
                secondary:
                  main: "#9c27b0"
                  dark: "#6a0080"
                  contrastText: "#ffffff"
                tertiary:
                  main: "#2e7d32"
                  dark: "#1b5e20"
                  contrastText: "#ffffff"
            light:
              colors:
                primary:
                  main: "#2196f3"
                  dark: "#1976d2"
                  contrastText: "#ffffff"
                secondary:
                  main: "#9c27b0"
                  dark: "#6a0080"
                  contrastText: "#ffffff"

    Link:
      type: object
      properties:
        href:
          type: string
          example: "branding?offset=20&limit=10"
        rel:
          type: string
          example: "next"

    Error:
      type: object
      required: [code, message]
      properties:
        code:
          type: string
          description: Error code
          example: "BRD-1001"
        message:
          type: string
          description: Error message
          example: "Invalid request format"
        description:
          type: string
          description: Detailed error description
          example: "The request body is malformed or contains invalid data"

